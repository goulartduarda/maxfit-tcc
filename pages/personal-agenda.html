<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MaxFit — Personal (Agenda/Lembretes)</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <style>
    :root {
      --mf-primary:#FF6A00;
      --mf-bg:#0f0f10;
      --mf-card:#17181a;
      --mf-border:#2a2b2e;
    }
    body {
      background:linear-gradient(180deg, var(--mf-bg), #121317 60%);
      color:#e9ecef;
    }
    .mf-card {
      background:var(--mf-card);
      border:1px solid var(--mf-border);
      border-radius:1.25rem;
      padding:1.5rem;
    }
    .mf-btn {
      background:var(--mf-primary);
      color:#fff;
      border:none;
      padding:.6rem 1.2rem;
      border-radius:.6rem;
    }
    .mf-btn:hover { opacity:.9; }
    .mf-btn-outline {
      border:1px solid var(--mf-primary);
      color:var(--mf-primary);
      padding:.4rem .9rem;
      border-radius:.6rem;
      text-decoration:none;
    }
    .mf-btn-outline:hover {
      background:var(--mf-primary);
      color:#fff;
    }
  </style>
</head>
<body>
  <div class="container py-4">

    <!-- Cabeçalho -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="h5 m-0">Agenda / Lembretes</h1>
      <a href="home-personal.html" class="mf-btn-outline">Voltar</a>
    </div>

    <!-- Formulário -->
    <div class="mf-card mb-4">
      <h2 class="h6">Novo Lembrete</h2>
      <form id="formLembrete" class="mt-3">
        <div class="mb-3">
          <label class="form-label">Aluno</label>
          <select id="alunoSelect" class="form-select"></select>
        </div>
        <div class="mb-3">
          <label class="form-label">Data</label>
          <input type="date" id="data" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Descrição</label>
          <textarea id="descricao" class="form-control" rows="3" placeholder="Ex.: Avaliação física marcada, mudança de treino..." required></textarea>
        </div>
        <button type="submit" class="mf-btn">Salvar Lembrete</button>
      </form>
    </div>

    <!-- Lista de lembretes -->
    <div class="mf-card">
      <h2 class="h6">Lembretes Cadastrados</h2>
      <ul id="listaLembretes" class="list-group list-group-flush mt-3"></ul>
    </div>

  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const alunos = JSON.parse(localStorage.getItem("usuarios") || "[]").filter(u => u.tipo === "aluno");
      const lembretes = JSON.parse(localStorage.getItem("lembretes") || "[]");

      const alunoSelect = document.getElementById("alunoSelect");
      const lista = document.getElementById("listaLembretes");

      // Preenche o select de alunos
      alunos.forEach(aluno => {
        const opt = document.createElement("option");
        opt.value = aluno.email;
        opt.textContent = aluno.nome;
        alunoSelect.appendChild(opt);
      });

      // Renderiza lista de lembretes
      function renderizar() {
        lista.innerHTML = "";
        if (lembretes.length === 0) {
          lista.innerHTML = "<li class='list-group-item bg-dark text-white-50'>Nenhum lembrete cadastrado.</li>";
          return;
        }
        lembretes.forEach(l => {
          const li = document.createElement("li");
          li.className = "list-group-item bg-dark text-light border-secondary";
          li.innerHTML = `<strong>${l.alunoNome}</strong> — ${l.data}<br><small>${l.descricao}</small>`;
          lista.appendChild(li);
        });
      }

      renderizar();

      // Salvar lembrete
      document.getElementById("formLembrete").addEventListener("submit", e => {
        e.preventDefault();

        const alunoEmail = alunoSelect.value;
        const alunoNome = alunos.find(a => a.email === alunoEmail)?.nome || "Desconhecido";
        const data = document.getElementById("data").value;
        const descricao = document.getElementById("descricao").value.trim();

        if (!alunoEmail || !data || !descricao) {
          alert("Preencha todos os campos!");
          return;
        }

        const novo = { alunoEmail, alunoNome, data, descricao };
        lembretes.push(novo);
        localStorage.setItem("lembretes", JSON.stringify(lembretes));

        document.getElementById("formLembrete").reset();
        renderizar();
      });
    });
  </script>
</body>
</html>
